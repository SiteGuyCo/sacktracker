<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sack Tracker Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Roboto',sans-serif;background:#121212;color:#f0f0f0;margin:0;padding:1rem;}
        table{width:100%;border-collapse:collapse;margin-top:1rem;}
        th,td{border-bottom:1px solid #333;padding:0.5rem;text-align:left;}
        input[type="number"]{width:5rem;}
        button{padding:0.3rem 0.8rem;margin-left:0.5rem;}
    </style>
</head>
<body>
    <h1>Sack Tracker Admin</h1>
    <div>
        <label>Username: <input id="username" type="text" value="admin"></label>
        <label>Password: <input id="password" type="password"></label>
    </div>
    <table id="vendor-table">
        <thead>
            <tr><th>Vendor</th><th>Price</th><th>Active</th><th></th></tr>
        </thead>
        <tbody></tbody>
    </table>
<script>
async function loadVendors(){
    const res = await fetch('/api/vendors');
    const data = await res.json();
    const tbody = document.querySelector('#vendor-table tbody');
    tbody.innerHTML='';
    data.vendors.forEach((v,i)=>{
        const row = document.createElement('tr');
        row.innerHTML=`<td>${v.name}</td>`+
            `<td><input type="number" step="0.01" value="${v.price}" id="p${i}"></td>`+
            `<td><input type="checkbox" id="a${i}" ${v.active? 'checked':''}></td>`+
            `<td><button onclick="save(${i})">Save</button></td>`;
        tbody.appendChild(row);
    });
}

async function save(i){
    const u=document.getElementById('username').value;
    const p=document.getElementById('password').value;
    const auth='Basic '+btoa(u+':'+p);
    const price=parseFloat(document.getElementById('p'+i).value);
    const active=document.getElementById('a'+i).checked;
    await fetch('/api/vendors/'+i,{method:'POST',headers:{'Content-Type':'application/json','Authorization':auth},body:JSON.stringify({price,active})});
    await loadVendors();
}

loadVendors();
</script>
</body>
</html>
